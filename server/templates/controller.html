var {{ serviceImplName }} =  require("../impls/{{ serviceImplName }}");
var {{ controllerName }} = {

{%- for apiMethod in apiMethods -%}
{%- for operation in apiMethod.operations -%}

{{ operation.nickname }}: function (req, res) {
    var response,err = validateParams(req);
    if (err) {
        response= '{"Error":"There have been validation errors"}';
    }else {
    response = {{ serviceImplName }}.{{ operation.nickname }}(req, res);
    }
    res.send(response);
}
{%- if loop.length >1 and !loop.last -%}
,
{%- endif -%}

{%- endfor -%}
{%- if loop.length >1 and !loop.last -%}
,
{%- endif -%}
{%- endfor -%}

}

var validateParams = function(req, methodType) {
    var params = Object.keys(req.params);
    if( params.length >0) {
        for(pindex in params){
        req.checkParams(params[pindex], 'Invalid url param').isAlphanumeric();
        }
    }
    var queryParams =  Object.keys(req.query);
    if(queryParams.length>0){
        for(qindex in queryParam){
        req.checkQuery(queryParam[qindex], 'Invalid url param').isAlphanumeric();
        }
    }
    {%- for apiMethod in apiMethods -%}
    {%- for operation in apiMethod.operations -%}
        if(methodType ==="{{ operation.httpMethod}}"){
    {%- for parameter in operation.parameters -%}
    {%- if parameter.dataType ==='string'  -%}
    req.checkBody('{{parameter.name}}', 'Invalid body params').notEmpty().isAlphanumeric();
    {%- endif -%}
    {%- if parameter.dataType ==='int' -%}
    req.checkBody('{{parameter.name}}', 'Invalid body params').notEmpty().isInt();
    {%- endif -%}
    {%- if parameter.dataType ==='date'  -%}
    req.checkBody('{{parameter.name}}', 'Invalid body params').notEmpty().isDate();
    {%- endif -%}
    {%- if parameter.dataType ==='email'  -%}
    req.checkBody('{{parameter.name}}', 'Invalid body params').notEmpty().isEmail();
    {%- endif -%}
    {%- endfor -%}
        }
    {%- endfor -%}
    {%- endfor -%}
return req.validationErrors();
}
module.exports = {{ controllerName }};

